---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
Read the csv file and then check the structure of the file.
```{r}
activity<-read.csv("./activity/activity.csv", header=TRUE)
str(activity)
```
Reformat the date and check that it is a 'date' class. 
```{r}
library(lubridate)
activity$date<-ymd(activity$date)
str(activity)
```

Re-group the data into dates. 
```{r}
library(dplyr)
tbl_df(activity)
perday<-group_by(activity, date)
```
## What is mean total number of steps taken per day?

Calculate the total number of steps taken per day. 
```{r}
totalperday<-summarise(perday, totalsteps = sum(steps))
library(ggplot2)
qplot(totalsteps, data=totalperday, geom="histogram")
mean(totalperday$totalsteps, na.rm=TRUE)
median(totalperday$totalsteps, na.rm=TRUE)
```

## What is the average daily activity pattern?
Calculate the average number of steps taken
```{r}
average<-mutate(perday,averagedsteps=mean(steps, na.rm=TRUE))
```

Calculate the average number of steps taken per day
```{r}
average2<-mutate(average, aveday = mean(averagedsteps, na.rm=TRUE))

```
Make a time series plot (i.e. `type = "l"`) of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r}
plot(average$interval, average$averagedsteps, type="l", xlab="interval", ylab="average number of steps taken" )
```
## Imputing missing values

1. Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with `NA`s)
```{r}
sum(is.na(activity))
```
2. Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5-minute interval, etc.

- replace na by the mean number of steps  

3. Create a new dataset that is equal to the original dataset but with the missing data filled in.
```{r}
impute.mean<-replace(activity, is.na(activity), mean(activity$steps, na.rm = TRUE))

```

## Are there differences in activity patterns between weekdays and weekends?
